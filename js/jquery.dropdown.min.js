(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{if(typeof exports==="object"){module.exports=a(require("jquery"))}else{a(jQuery)}}}(function(b){var a={options:{optionClass:"",dropdownClass:"",autoinit:false,callback:false,onSelected:false,dynamicOptLabel:"Add a new option..."},init:function(c){if(c){c=b.extend(a.options,c)}else{c=a.options}function d(j){if(j.data("dropdownjs")||!j.is("select")){return}var m=j.attr("multiple");var o=j.attr("data-dynamic-opts"),h=b();var n=b("<div></div>");n.addClass("dropdownjs").addClass(c.dropdownStyle);n.data("select",j);var p=b("<input type=text readonly class=fakeinput>");if(b.material){p.data("mdproc",true)}n.append(p);var l=b("<ul></ul>");l.data("select",j);n.append(l);p.attr("placeholder",j.attr("placeholder"));j.find("option").each(function(){var i=b(this);a._addOption(l,i)});if(o){h=b("<li class=dropdownjs-add></li>");h.append("<input>");h.find("input").attr("placeholder",c.dynamicOptLabel);l.append(h)}var f=n.find("li");if(!m){var e;if(j.find(":selected").length){e=j.find(":selected").last()}else{e=j.find("option, li").first()}a._select(n,e)}else{var q=[],g=j.val();for(var k in g){q.push("li[value="+g[k]+"]")}if(q.length>0){a._select(n,n.find(q.join(",")))}}p.addClass(j[0].className);j.hide().attr("data-dropdownjs",true);j.after(n);if(c.callback){c.callback(n)}l.on("click","li:not(.dropdownjs-add)",function(i){a._select(n,b(this));j.change()});l.on("keydown","li:not(.dropdownjs-add)",function(i){if(i.which===27){b(".dropdownjs > ul > li").attr("tabindex",-1);return p.removeClass("focus").blur()}if(i.which===32&&!b(i.target).is("input")){a._select(n,b(this));return false}});l.on("focus","li:not(.dropdownjs-add)",function(){if(j.is(":disabled")){return}p.addClass("focus")});if(o&&o.length){h.on("keydown",function(r){if(r.which!==13){return}var i=b("<option>"),s=h.find("input").val();h.find("input").val("");i.attr("value",s);i.text(s);j.append(i)})}j.on("DOMNodeInserted",function(r){var i=b(r.target);if(!i.val().length){return}a._addOption(l,i);l.find("li").not(".dropdownjs-add").attr("tabindex",0)});j.on("change",function(s){var r=b(s.target);if(!r.val().length){return}if(!m){var i;if(j.find(":selected").length){i=j.find(":selected").last()}else{i=j.find("option, li").first()}a._select(n,i)}else{a._select(n,j.find(":selected"))}});p.on("click focus",function(s){s.stopPropagation();if(j.is(":disabled")){return}b(".dropdownjs > ul > li").attr("tabindex",-1);b(".dropdownjs > input").not(b(this)).removeClass("focus").blur();b(".dropdownjs > ul > li").not(".dropdownjs-add").attr("tabindex",0);var r={top:b(this).offset().top-b(document).scrollTop(),left:b(this).offset().left-b(document).scrollLeft(),bottom:b(window).height()-(b(this).offset().top-b(document).scrollTop()),right:b(window).width()-(b(this).offset().left-b(document).scrollLeft())};var i=r.bottom;if(i<200&&r.top>r.bottom){i=r.top;l.attr("placement","top-left")}else{l.attr("placement","bottom-left")}b(this).next("ul").css("max-height",i-20);b(this).addClass("focus")});b(document).on("click",function(i){if(m&&b(i.target).parents(".dropdownjs").length){return}if(b(i.target).parents(".dropdownjs-add").length||b(i.target).is(".dropdownjs-add")){return}b(".dropdownjs > ul > li").attr("tabindex",-1);p.removeClass("focus")})}if(c.autoinit){b(document).on("DOMNodeInserted",function(g){var f=b(g.target);if(!f.is("select")){f=f.find("select")}if(f.is(c.autoinit)){f.each(function(){d(b(this))})}})}b(this).each(function(){d(b(this))})},select:function(d){var c=b(this).find('[value="'+d+'"]');a._select(b(this),c)},_select:function(g,c){if(c.is(".dropdownjs-add")){return}var e=g.data("select"),i=g.find("input.fakeinput");var f=e.attr("multiple");var d=g.find("li");if(f){c.toggleClass("selected");c.each(function(){var j=e.find('[value="'+b(this).attr("value")+'"]');j.prop("selected",b(this).hasClass("selected"))});var h=[];d.each(function(){if(b(this).hasClass("selected")){h.push(b(this).text())}});i.val(h.join(", "))}if(!f){if(c.is("li")){d.not(c).removeClass("selected")}c.addClass("selected");e.val(c.attr("value"));i.val(c.text().trim())}if(b.material){if(i.val().trim()){e.removeClass("empty")}else{e.addClass("empty")}}if(this.options.onSelected){this.options.onSelected(c.attr("value"))}},_addOption:function(c,e){var d=b("<li></li>");d.addClass(this.options.optionStyle);if(e.text()){d.text(e.text())}else{d.html("&nbsp;")}d.attr("value",e.val());if(c.data("select").attr("data-dynamic-opts")){d.append("<span class=close></span>");d.find(".close").on("click",function(){d.remove();e.remove()})}if(e.prop("selected")){d.attr("selected",true);d.addClass("selected")}if(c.find(".dropdownjs-add").length){c.find(".dropdownjs-add").before(d)}else{c.append(d)}}};b.fn.dropdown=function(c){if(a[c]){return a[c].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof c==="object"|!c){return a.init.apply(this,arguments)}else{b.error("Method "+c+" does not exists on jQuery.dropdown")}}}}));